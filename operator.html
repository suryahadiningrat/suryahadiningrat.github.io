<html>
  <body>
    <style>
      #outgoing {
        width: 600px;
        word-wrap: break-word;
        white-space: normal;
      }
    </style>
    <video id="user"></video>
    <video id="operator"></video>
    <video id="volunteer"></video>

    <button onclick="call()">Answer Call</button>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/simple-peer/9.11.0/simplepeer.min.js" integrity="sha512-0f7Ahsuvr+/P2btTY4mZIw9Vl23lS6LY/Y7amdkmUg2dqsUF+cTe4QjWvj/NIBHJoGksOiqndKQuI9yzn2hB0g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
        // get video/voice stream
        const call = () => {
          navigator.mediaDevices.getUserMedia({
              video: true,
              audio: true
          }).then(gotMedia).catch((e) => { alert(e) });
        }

        function gotMedia (stream) {
            playOurVideo(stream);
            const userPeer = new SimplePeer({ stream: stream, trickle: false });
            const rdp = prompt("Enter RDP : ");

            if ( rdp ) {    
                userPeer.signal(JSON.parse(rdp));

                userPeer.on('signal', (data) => {
                    console.log(JSON.stringify(data));
                });

                userPeer.on('stream', (stream) => {
                    // got remote video stream, now let's show it in a video tag
                    const video = document.querySelector('#user')

                    if ('srcObject' in video) {
                        video.srcObject = stream
                    } else {
                        video.src = window.URL.createObjectURL(stream) // for older browsers
                    }

                    video.play()
                })
            }
        }

        const playOurVideo = (stream) => {
            // got remote video stream, now let's show it in a video tag
            const video = document.querySelector('#operator')

            if ('srcObject' in video) {
                video.srcObject = stream
            } else {
                video.src = window.URL.createObjectURL(stream) // for older browsers
            }

            video.play()
        }
    </script>
  </body>
</html>